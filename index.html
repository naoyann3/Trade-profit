<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KTCãƒˆãƒ¬ãƒ¼ãƒ‰åæ”¯è©¦ç®—è¡¨</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
<style>
    body { font-family: 'Noto Sans JP', sans-serif; background-color: #f8fafc; }
    .mono { font-family: 'Roboto Mono', monospace; }
    /* ã‚¹ãƒãƒ›ã§ã®å…¥åŠ›ã—ã‚„ã™ã•ã‚’èª¿æ•´ */
    input[type="number"] { padding-right: 5px; }
    
    /* ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    .modal { transition: opacity 0.25s ease; }
    body.modal-active { overflow-x: hidden; overflow-y: hidden !important; }
</style>
</head>
<body class="p-2 md:p-8 text-slate-700">

<div class="max-w-3xl mx-auto bg-white shadow-lg rounded-xl overflow-hidden border border-slate-200 relative z-0">
    
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="bg-slate-800 text-white p-5">
        <h2 class="text-xl font-bold flex items-center gap-2">
            ğŸ“Š çŸ­æœŸãƒˆãƒ¬ãƒ¼ãƒ‰åæ”¯è©¦ç®—è¡¨
        </h2>
        <p class="text-xs text-slate-400 mt-1">10åˆ†å‰²ãƒ”ãƒ©ãƒŸãƒƒãƒ†ã‚£ãƒ³ã‚°æ–¹å¼ãƒ»å®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿æº–æ‹ </p>
    </div>

    <div class="p-4 md:p-6 space-y-8">
        
        <!-- åŸºæœ¬è¨­å®šã‚¨ãƒªã‚¢ -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div>
                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">é‹ç”¨è³‡é‡‘ (å††)</label>
                <input type="text" id="capital" value="1,000,000" oninput="formatCurrencyInput(this)" class="mono w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-blue-500 outline-none text-right font-bold text-lg">
            </div>
            <div>
                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">1å›ã®åˆ©å¹…ç›®æ¨™ (%)</label>
                <input type="number" id="profitRate" value="3.0" step="0.1" class="mono w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-blue-500 outline-none text-right font-bold text-lg">
            </div>
            <div>
                <label class="block text-xs font-bold text-slate-500 uppercase mb-1">æœˆé¡çµŒè²» (ä¼šè²»ç­‰)</label>
                <input type="text" id="cost" value="20,000" oninput="formatCurrencyInput(this)" class="mono w-full p-2 border border-slate-300 rounded focus:ring-2 focus:ring-blue-500 outline-none text-right font-bold text-lg">
            </div>
        </div>

        <hr class="border-slate-100">

        <!-- ãƒ—ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ -->
        <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
            <div class="flex justify-between items-center mb-3">
                <h3 class="font-bold text-sm text-blue-800">âš¡ï¸ ç›¸å ´ç’°å¢ƒãƒ—ãƒªã‚»ãƒƒãƒˆ (è‡ªå‹•å…¥åŠ›)</h3>
                <button onclick="toggleModal()" class="text-xs bg-white border border-blue-200 text-blue-600 px-2 py-1 rounded hover:bg-blue-100 transition flex items-center gap-1">
                    <span>ğŸ“Š éå»ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚‹</span>
                </button>
            </div>
            <div class="grid grid-cols-3 gap-2 text-xs md:text-sm">
                <button onclick="applyPreset('bull')" class="bg-white hover:bg-emerald-50 border border-emerald-200 text-emerald-700 font-bold py-2 px-2 rounded shadow-sm transition">
                    ğŸš€ æ”»ã‚ã®ç›¸å ´<br><span class="font-normal text-xs opacity-80">(æœˆ 5.5å›æƒ³å®š)</span>
                </button>
                <button onclick="applyPreset('avg')" class="bg-white hover:bg-blue-50 border border-blue-200 text-blue-700 font-bold py-2 px-2 rounded shadow-sm transition">
                    âš–ï¸ å…¨æœŸé–“å¹³å‡<br><span class="font-normal text-xs opacity-80">(æœˆ 3.7å›æƒ³å®š)</span>
                </button>
                <button onclick="applyPreset('bear')" class="bg-white hover:bg-slate-50 border border-slate-300 text-slate-600 font-bold py-2 px-2 rounded shadow-sm transition">
                    â„ï¸ å†¬ã®æ™‚ä»£<br><span class="font-normal text-xs opacity-80">(æœˆ 2.1å›æƒ³å®š)</span>
                </button>
            </div>
            <p class="text-[10px] text-slate-400 mt-2 text-right">â€»å®Ÿç¸¾ãƒ­ã‚°ã‚ˆã‚Šã€æµ…ã„ç‰(1-3)ã¨æ·±ã„ç‰ã®ç™ºç”Ÿæ¯”ç‡ã‚’è€ƒæ…®ã—ã¦é…åˆ†</p>
        </div>

        <!-- ãƒ”ãƒ©ãƒŸãƒƒãƒ†ã‚£ãƒ³ã‚°å…¥åŠ›ã‚¨ãƒªã‚¢ -->
        <div>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left">
                    <thead class="text-xs text-slate-500 uppercase bg-slate-50 border-b">
                        <tr>
                            <th class="p-2 w-12">ç‰No.</th>
                            <th class="p-2 w-16">é…åˆ†</th>
                            <th class="p-2 text-right">æŠ•è³‡é‡‘é¡</th>
                            <th class="p-2 text-right">1å›ã®åˆ©ç›Š</th>
                            <th class="p-2 w-20 text-center">æœˆé–“å›æ•°</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- JSã§è‡ªå‹•ç”Ÿæˆ -->
                    </tbody>
                </table>
            </div>
            <p class="text-xs text-right text-slate-400 mt-2">è³‡é‡‘é…åˆ†ç‡åˆè¨ˆ: <span id="total-allocation">0</span>%</p>
        </div>

        <!-- çµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
        <div class="bg-slate-100 rounded-lg p-5 border border-slate-200">
            <div class="grid grid-cols-2 gap-4 mb-4">
                <div>
                    <p class="text-xs text-slate-500">æœˆé–“ ç²—åˆ©ç›Š (Gross)</p>
                    <p class="mono text-xl font-bold text-blue-600" id="gross-profit">0</p>
                </div>
                <div>
                    <p class="text-xs text-slate-500">æœˆé–“ çµŒè²» (Cost)</p>
                    <p class="mono text-xl font-bold text-red-500" id="display-cost">0</p>
                </div>
            </div>
            
            <div class="border-t border-slate-300 pt-4">
                <div class="flex justify-between items-end mb-1">
                    <p class="font-bold text-slate-700">æœ€çµ‚æœˆé–“åæ”¯ (Net Profit)</p>
                    <p class="mono text-3xl font-bold" id="net-profit">0</p>
                </div>
                <div class="text-right mt-2">
                    <p class="text-xs text-slate-500" id="status-message">---</p>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- ãƒ‡ãƒ¼ã‚¿å‚ç…§ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="data-modal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-50">
    <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50" onclick="toggleModal()"></div>
    
    <div class="modal-container bg-white w-11/12 md:max-w-2xl mx-auto rounded shadow-lg z-50 overflow-y-auto max-h-[90vh]">
        <div class="modal-content py-4 text-left px-6">
            <!-- Title -->
            <div class="flex justify-between items-center pb-3 border-b">
                <p class="text-lg font-bold">ğŸ“Š BTCæœˆé–“å¹³å‡æ±ºæ¸ˆå›æ•° (å®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿)</p>
                <div class="cursor-pointer z-50" onclick="toggleModal()">
                    <svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                        <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                    </svg>
                </div>
            </div>

            <!-- Body -->
            <div class="my-5 text-sm text-slate-600 space-y-6">
                <p class="text-xs bg-yellow-50 p-2 rounded text-yellow-800">
                    â€»ä¸»å‚¬è€…ï¼ˆè‡ªç”±å„„ï¼‰ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ­ã‚°ã‚ˆã‚Šã€ŒBTCã®æ±ºæ¸ˆï¼ˆåˆ©ç¢ºãƒ»æåˆ‡ã‚Šï¼‰ã€ã®ã¿ã‚’æŠ½å‡ºãƒ»é›†è¨ˆã—ãŸãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚<br>
                    â€»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼å…¥åŠ›ã®å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
                </p>

                <div>
                    <h4 class="font-bold mb-2 text-slate-800">ğŸ“Œ å¹´åº¦åˆ¥ å¹³å‡å›æ•°</h4>
                    <table class="w-full text-center border-collapse border border-slate-200">
                        <tr class="bg-slate-100 text-xs">
                            <th class="border p-2">å¹´åº¦</th>
                            <th class="border p-2">æœˆé–“å¹³å‡</th>
                            <th class="border p-2">ç›¸å ´ç’°å¢ƒ</th>
                        </tr>
                        <tr>
                            <td class="border p-2">2025å¹´</td>
                            <td class="border p-2 font-bold text-blue-600">5.5å›</td>
                            <td class="border p-2 text-xs text-left">ãƒãƒ–ãƒ«ãƒ»é«˜å›è»¢</td>
                        </tr>
                        <tr>
                            <td class="border p-2">2024å¹´</td>
                            <td class="border p-2 font-bold">4.0å›</td>
                            <td class="border p-2 text-xs text-left">åŠæ¸›æœŸå‰å¾Œãƒ»ä¸Šæ˜‡</td>
                        </tr>
                        <tr>
                            <td class="border p-2">2023å¹´</td>
                            <td class="border p-2">3.2å›</td>
                            <td class="border p-2 text-xs text-left">ãƒ¬ãƒ³ã‚¸ãƒ»å›å¾©æœŸ</td>
                        </tr>
                        <tr>
                            <td class="border p-2">2022å¹´</td>
                            <td class="border p-2 text-slate-400">2.1å›</td>
                            <td class="border p-2 text-xs text-left">å†¬ã®æ™‚ä»£ãƒ»è€ãˆ</td>
                        </tr>
                        <tr class="bg-slate-50 font-bold">
                            <td class="border p-2">å…¨æœŸé–“</td>
                            <td class="border p-2">3.7å›</td>
                            <td class="border p-2 text-xs text-left">å¹³å‡å€¤</td>
                        </tr>
                    </table>
                </div>

                <div>
                    <h4 class="font-bold mb-2 text-slate-800">ğŸ“… æœˆåˆ¥ è©³ç´°ãƒ‡ãƒ¼ã‚¿</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full text-center text-xs border-collapse border border-slate-200">
                            <thead class="bg-slate-100">
                                <tr>
                                    <th class="border p-1">å¹´</th>
                                    <th class="border p-1">1æœˆ</th><th class="border p-1">2æœˆ</th><th class="border p-1">3æœˆ</th>
                                    <th class="border p-1">4æœˆ</th><th class="border p-1">5æœˆ</th><th class="border p-1">6æœˆ</th>
                                    <th class="border p-1">7æœˆ</th><th class="border p-1">8æœˆ</th><th class="border p-1">9æœˆ</th>
                                    <th class="border p-1">10æœˆ</th><th class="border p-1">11æœˆ</th><th class="border p-1">12æœˆ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="border p-1 font-bold">2025</td>
                                    <td class="border p-1">4</td><td class="border p-1">4</td><td class="border p-1">5</td>
                                    <td class="border p-1">4</td><td class="border p-1">5</td><td class="border p-1">5</td>
                                    <td class="border p-1">6</td><td class="border p-1 bg-blue-100">7</td><td class="border p-1">6</td>
                                    <td class="border p-1">7</td><td class="border p-1 bg-blue-100">8</td><td class="border p-1">-</td>
                                </tr>
                                <tr>
                                    <td class="border p-1 font-bold">2024</td>
                                    <td class="border p-1">3</td><td class="border p-1">4</td><td class="border p-1">5</td>
                                    <td class="border p-1">3</td><td class="border p-1">4</td><td class="border p-1">4</td>
                                    <td class="border p-1">5</td><td class="border p-1">3</td><td class="border p-1">3</td>
                                    <td class="border p-1">4</td><td class="border p-1">5</td><td class="border p-1">5</td>
                                </tr>
                                <tr>
                                    <td class="border p-1 font-bold">2023</td>
                                    <td class="border p-1">2</td><td class="border p-1">3</td><td class="border p-1">4</td>
                                    <td class="border p-1">4</td><td class="border p-1">2</td><td class="border p-1">4</td>
                                    <td class="border p-1">4</td><td class="border p-1">3</td><td class="border p-1">3</td>
                                    <td class="border p-1">3</td><td class="border p-1">3</td><td class="border p-1">3</td>
                                </tr>
                                <tr>
                                    <td class="border p-1 font-bold">2022</td>
                                    <td class="border p-1">2</td><td class="border p-1">3</td><td class="border p-1">3</td>
                                    <td class="border p-1 text-slate-300">1</td><td class="border p-1 text-slate-300">1</td><td class="border p-1">2</td>
                                    <td class="border p-1">2</td><td class="border p-1">2</td><td class="border p-1">2</td>
                                    <td class="border p-1">2</td><td class="border p-1 text-slate-300">1</td><td class="border p-1">2</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="flex justify-end pt-2">
                <button onclick="toggleModal()" class="px-4 py-2 bg-slate-500 p-3 rounded-lg text-white hover:bg-slate-400 text-sm">é–‰ã˜ã‚‹</button>
            </div>
        </div>
    </div>
</div>

<script>
    // ã‚¿ã‚±ã•ã‚“å¼ãƒ”ãƒ©ãƒŸãƒƒãƒ†ã‚£ãƒ³ã‚°é…åˆ†
    const allocations = [2, 3, 5, 7, 8, 10, 12, 15, 18, 20];
    
    // ãƒ—ãƒªã‚»ãƒƒãƒˆå®šç¾© (æµ…ã„ç‰ä¸­å¿ƒã®æ¯”ç‡ã§æ§‹æˆ)
    // logic: åˆ©ç›Šã®85%ã¯1-3ç‰ç›®ã€‚æ·±ã„ç‰ã¯ç¨€ã€‚
    const presets = {
        // 2025å¹´ãƒãƒ–ãƒ« (æœˆå¹³å‡ 5.5å›)
        bull: [3, 2, 1, 0, 0, 0, 0, 0, 0, 0], 
        // å…¨æœŸé–“å¹³å‡ (æœˆå¹³å‡ 3.7å›)
        avg:  [2, 1, 1, 0, 0, 0, 0, 0, 0, 0],
        // 2022å¹´å†¬ (æœˆå¹³å‡ 2.1å›)
        bear: [1, 1, 0, 0, 0, 0, 0, 0, 0, 0]
    };

    // åˆæœŸè¡¨ç¤ºã¯ã€Œå¹³å‡ã€ã‚’ä½¿ç”¨
    let currentWins = [...presets.avg];

    function init() {
        const tbody = document.getElementById('table-body');
        let html = '';
        
        allocations.forEach((rate, index) => {
            // 1-3ç‰ç›®ã‚’å¼·èª¿è¡¨ç¤º
            const highlight = index < 3 ? 'bg-yellow-50' : '';
            const fontStyle = index < 3 ? 'font-bold text-slate-700' : 'text-slate-400';

            html += `
                <tr class="border-b hover:bg-slate-50 transition ${highlight}">
                    <td class="p-2 font-mono ${fontStyle} text-center">#${index + 1}</td>
                    <td class="p-2 font-mono text-slate-500 text-center">${rate}%</td>
                    <td class="p-2 font-mono font-bold text-right" id="amount-${index}">0</td>
                    <td class="p-2 font-mono text-blue-600 text-right" id="win-profit-${index}">0</td>
                    <td class="p-2">
                        <input type="number" min="0" id="win-input-${index}" 
                            class="mono w-full p-1 border border-slate-300 rounded text-center focus:bg-blue-50 outline-none win-input"
                            oninput="calculate()">
                    </td>
                </tr>
            `;
        });
        tbody.innerHTML = html;
        
        document.getElementById('total-allocation').textContent = allocations.reduce((a, b) => a + b, 0);
        
        // åˆæœŸå€¤ã‚’ã‚»ãƒƒãƒˆ
        applyWinsToInputs(currentWins);
        calculate();
    }

    // ãƒ—ãƒªã‚»ãƒƒãƒˆé©ç”¨ãƒœã‚¿ãƒ³
    function applyPreset(type) {
        if (presets[type]) {
            applyWinsToInputs(presets[type]);
            calculate();
        }
    }

    function applyWinsToInputs(winsArray) {
        winsArray.forEach((val, idx) => {
            const input = document.getElementById(`win-input-${idx}`);
            if (input) {
                input.value = val;
            }
        });
        // æ®‹ã‚Šã®inputï¼ˆé…åˆ—ã‚ˆã‚Šå¤šã„åˆ†ï¼‰ã¯0ã«ã™ã‚‹
        for (let i = winsArray.length; i < allocations.length; i++) {
             const input = document.getElementById(`win-input-${i}`);
             if (input) input.value = 0;
        }
    }

    function fmt(num) {
        return num.toLocaleString() + ' å††';
    }

    function formatCurrencyInput(input) {
        let val = input.value.replace(/[^0-9]/g, '');
        if (val === '') val = '0';
        input.value = Number(val).toLocaleString();
        calculate();
    }

    function getNum(id) {
        const val = document.getElementById(id).value.replace(/[^0-9.]/g, '');
        return Number(val);
    }

    function calculate() {
        const capital = getNum('capital');
        const profitRate = getNum('profitRate') / 100;
        const cost = getNum('cost');

        let totalGross = 0;
        const winInputs = document.querySelectorAll('.win-input');

        allocations.forEach((rate, index) => {
            const investAmount = capital * (rate / 100);
            document.getElementById(`amount-${index}`).textContent = Math.floor(investAmount).toLocaleString();

            const oneWinProfit = investAmount * profitRate;
            document.getElementById(`win-profit-${index}`).textContent = '+' + Math.floor(oneWinProfit).toLocaleString();

            const wins = Number(winInputs[index].value);
            totalGross += oneWinProfit * wins;
        });

        const netProfit = totalGross - cost;

        document.getElementById('gross-profit').textContent = '+' + fmt(Math.floor(totalGross));
        document.getElementById('display-cost').textContent = 'â–²' + fmt(cost);
        
        const netEl = document.getElementById('net-profit');
        netEl.textContent = (netProfit > 0 ? '+' : '') + fmt(Math.floor(netProfit));
        
        const statusEl = document.getElementById('status-message');

        if (netProfit > 0) {
            netEl.className = "mono text-3xl font-bold text-emerald-600";
            statusEl.textContent = "âœ… ã‚³ã‚¹ãƒˆã‚’ä¸Šå›ã‚‹åˆ©ç›ŠãŒå‡ºã¦ã„ã¾ã™";
            statusEl.className = "text-xs text-emerald-600 font-bold";
        } else if (netProfit === 0) {
            netEl.className = "mono text-3xl font-bold text-slate-500";
            statusEl.textContent = "åæ”¯ãƒˆãƒ³ãƒˆãƒ³ã§ã™";
            statusEl.className = "text-xs text-slate-500";
        } else {
            netEl.className = "mono text-3xl font-bold text-rose-600";
            statusEl.textContent = "âš ï¸ åˆ©ç›Šã‚ˆã‚Šã‚‚ä¼šè²»ã‚³ã‚¹ãƒˆãŒä¸Šå›ã£ã¦ã„ã¾ã™";
            statusEl.className = "text-xs text-rose-600 font-bold";
        }
    }

    // ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡
    function toggleModal() {
        const body = document.querySelector('body');
        const modal = document.querySelector('.modal');
        modal.classList.toggle('opacity-0');
        modal.classList.toggle('pointer-events-none');
        body.classList.toggle('modal-active');
    }

    // ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚­ãƒ¼ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    document.onkeydown = function(evt) {
        evt = evt || window.event;
        var isEscape = false;
        if ("key" in evt) {
            isEscape = (evt.key === "Escape" || evt.key === "Esc");
        } else {
            isEscape = (evt.keyCode === 27);
        }
        if (isEscape && document.body.classList.contains('modal-active')) {
            toggleModal();
        }
    };

    document.getElementById('profitRate').addEventListener('input', calculate);
    window.onload = init;
</script>

</body>
</html>
